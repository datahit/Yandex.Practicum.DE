Привет Саша, тут мои комментарии:

UPD:
- вместо вьюшек сделал таблицы

Questions:
- какие бы рекомендации ты бы дал для связи таблиц (справочники + временные + итоговая вьюшка)? В задании таких рекомендаций не было.
- какие оптимизации кода возможны?
